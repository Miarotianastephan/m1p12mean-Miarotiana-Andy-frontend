<div class="w-full p-2">
    <p-card>
        <ng-template #title>Les demandes de devis des clients</ng-template>
    </p-card>
</div>
<div class="w-full flex justify-between p-2">
    <div class="card">
        <p-card>
            <p-table class="border border-primary-200 shadow-lg " [value]="problemReports" selectionMode="single" [(selection)]="selectedProblem" dataKey="_id"
                (onRowSelect)="onRowSelect($event)" (onRowUnselect)="onRowUnselect($event)" [tableStyle]="{'min-width': '50rem'}">
                
                <ng-template #header>
                    <tr>
                        <th>Utilisateur</th>
                        <th>Véhicule</th>
                        <th>Date de soumission</th>
                    </tr>
                </ng-template>
                
                <ng-template #body let-problem>
                    <tr [pSelectableRow]="problem">
                        <td>{{ problem.userId }}</td>
                        <td>{{ problem.carId }}</td>
                        <td>{{ problem.createdAt | date: 'dd/MM/yyyy HH:mm' }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </p-card>
    </div>

    <div class="mb-4 flex items-start justify-center">
        <p-card *ngIf="selectedProblem; else emptyCard" [style]="{ width: '25rem', overflow: 'hidden' }">
            <ng-template #header>
                <p-carousel *ngIf="selectedProblem.images.length > 0" [value]="selectedProblem.images" [numVisible]="1" [numScroll]="1">
                    <ng-template let-image pTemplate="item">
                        <img [src]="image" alt="Image du problème" class="w-full h-40 object-cover rounded-lg">
                    </ng-template>
                </p-carousel>
                <img *ngIf="!selectedProblem.images?.length" alt="Aucune image" class="w-full h-40 object-cover rounded-lg"
                    src="https://via.placeholder.com/400?text=Aucune+image">
            </ng-template>
            <ng-template #title> Details du probleme </ng-template>
            <ng-template #subtitle>Du : {{selectedProblem.datereportProblem | date: 'dd/MM/yyyy HH:mm'}} </ng-template>
            <p>
                {{selectedProblem.description}}
            </p>
            <ng-template #footer>
                <div class="flex gap-4 mt-1">
                    <p-button label="Creer un devis" class="w-full" styleClass="w-full" />
                </div>
            </ng-template>
        </p-card>

        <ng-template #emptyCard>
            <p-card [style]="{ width: '25rem', overflow: 'hidden' }">
                <ng-template #title> Aucun problème sélectionné </ng-template>
                <p>
                    Veuillez sélectionner un problème pour voir les détails.
                </p>
            </p-card>
        </ng-template>
    </div>
</div>